if(USE_ZLIB)
  message(CHECK_START "Checking for libz")
  if(NOT ZLIB_LIBRARY)
    pkg_search_module(ZLIB zlib libz z QUIET)
    if(ZLIB_FOUND)
      if(ZLIB_LIBRARIES)
        set(ZLIB_LIBRARY "${ZLIB_LIBRARIES}" CACHE FILEPATH "")
      endif(ZLIB_LIBRARIES)
    else(ZLIB_FOUND)
      # include(FindZlib)
    endif(ZLIB_FOUND)
  endif(NOT ZLIB_LIBRARY)

  if(NOT ZLIB_LIBRARY)

    find_library(ZLIB_LIBRARY z)
    if(ZLIB_LIBRARY)
      message(STATUS "Found libz: ${ZLIB_LIBRARY}")
      set(ZLIB_FOUND TRUE)
      if(NOT "${ZLIB_LIBRARY}" STREQUAL "")
        set(ZLIB_LIBRARIES "${ZLIB_LIBRARY}")
      endif(NOT "${ZLIB_LIBRARY}" STREQUAL "")

    endif(ZLIB_LIBRARY)
  endif(NOT ZLIB_LIBRARY)

  if(ZLIB_LIBRARY)
    message(CHECK_PASS "found")
  else(ZLIB_LIBRARY)
    message(CHECK_FAIL "NOT found")
  endif(ZLIB_LIBRARY)

else(USE_ZLIB)
  unset(ZLIB_LIBRARY CACHE)
endif(USE_ZLIB)
